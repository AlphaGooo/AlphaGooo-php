
#处理一些PHP常见的问题和异常

## php开启内存限制，自定义配置
由于 PHP 一半都会设置内存最大值，所以当程序脚本运行所消耗的内存超过最大值时，则会触发错误：
```
（PHP Fatal error: Allowed memory size of 134217728 bytes exhausted）
```

### 解决方案：
```
<?php
  // 设置内存使用限制，配置2G
  ini_set('memory','2048M');
?>
```

## php脚本报错“Killed”

1.因为程序操作数据过于庞大，超出了php-fpm设置的内存峰值。

2.由于程序逻辑错误，导致出现无限循环，从而耗尽内存。

### 解决方案：

1.增加这个PHP程序可用的可用内存量或内存量。

2.将问题分解成更小的顺序运行的块。

3.重写程序，因此它具有较小的内存要求，或者递归不会如此深入。

## php正则匹配字符

无论是匹配英文字符还是中文字符，正则匹配还是最好的选择。

### 解决方案：

```
<?php
    // 使用了 i 修正符，因此会不区分大小写去文本中匹配 php
    if(preg_match("/php/i", "PHP is the web scripting language of choice.", $matches)){
        print "匹配成功！找到了字符:". $matches[0];
    } else {
        print "匹配失败，没有找到字符！";
    }
?>
```

## php自动补全

有时候需要针对位数不足的情况，在指定位置补全字符，可以用php自带的函数 sprintf 实现。

### 解决方案

```
<?php
    // 生成10位数，不足的话，前面补0
    $code = sprintf("%010d", 1001);
    
    echo $code;// 结果为0000001001
?>
```
